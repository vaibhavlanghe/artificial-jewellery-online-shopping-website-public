/*!
 * jquery.wm-zoom - v 1.0
 * desenvolvido por Welison Menezes
 * email : welisonmenezes@gmail.com
 * 
 *
 * Copyright 2014 Welison Menezes
 * @license http://www.opensource.org/licenses/mit-license.html MIT License
 * @license http://www.gnu.org/licenses/gpl.html GPL2 License 
 */
!function(t){"use strict";t.fn.extend({WMZoom:function(i){var o={config:{stageW:500,stageH:400,inner:!1,position:"right",margin:10}},i=t.extend(!0,o,i);return this.each(function(){var o,n=t(this),e=n.find(".wm-zoom-box"),s=e.find("img"),f=s.attr("data-loader-src"),a=t("<div />").addClass("wm-zoom-lens"),p=t("<div />").addClass("wm-zoom-hight"),c=t("<img />").addClass("wm-zoom-loader").attr("src",f);e.append(a),p.html(c),e.prepend(p);var g,h,d,r,m,l,u,x,w,v,z,C,I,M,W,b,H,O,j,y,Q,T,X,Y,Z,k,q,A,B=function(){g=s.width(),h=s.height(),d=n.offset(),i.config.inner===!0?(q=g,A=h):(q=i.config.stageW,A=i.config.stageH),e.css({height:h+"px",width:g+"px"}),p.css({height:A+"px",width:q+"px"}),i.config.inner===!0?p.css({top:"0px",left:"0px"}):("right"===i.config.position&&p.css({top:"0px",left:g+i.config.margin+"px"}),"bottom"===i.config.position&&p.css({top:h+i.config.margin+"px",left:"0px"}),"top"===i.config.position&&p.css({top:"-"+(A+i.config.margin)+"px",left:"0px"}),"left"===i.config.position&&p.css({top:"0px",left:"-"+(q+i.config.margin)+"px"}))},D=function(){i.config.inner!==!0&&a.stop().fadeIn(300),p.stop().fadeIn(300),u=c.width(),x=c.height(),w=q/2-u/2,v=A/2-x/2,c.css({top:v+"px",left:w+"px"}),l=!0},E=function(){if(o.length<1){var i=s.attr("data-hight-src");if(0==r){r=!0,m=!1;var n=new Image;t(n).addClass("wm-zoom-hight-img").attr("src",i).load(function(){o.remove(),p.append(n),m=!0})}}else r=!0,m=!0},F=function(){B(),r=!1,m=!1,l=!1,e.mouseenter(function(){D()}).mousemove(function(i){t(this);return o=p.find("img.wm-zoom-hight-img"),l===!1&&D(),E(),1!=m&&1!=r?!1:(z=p.width(),C=p.height(),I=o.width(),M=o.height(),W=q*g/I,b=A*h/M,H=W/2,O=b/2,b>h&&(b=h),W>g&&(W=g),a.css({width:W,height:b}),j=i.pageX-d.left,y=i.pageY-d.top,(j>g||0>j||y>h||0>y)&&(a.hide(),p.hide()),Q=j-H,0>Q?Q=0:Q>g-W&&(Q=g-W),T=y-O,0>T?T=0:T>h-b&&(T=h-b),a.css({left:Q+"px",top:T+"px"}),X=(I-z/2)/(g-H),Y=Math.ceil(X*Q),Y>I-z&&(Y=I-z),Z=(M-C/2)/(h-O),k=Math.ceil(Z*T),k>M-C&&(k=M-C),void o.css({left:"-"+Y+"px",top:"-"+k+"px"}))}).mouseleave(function(){a.stop().fadeOut(300),p.stop().fadeOut(300),l=!1})};t(window).load(function(){setTimeout(function(){F()},25)})})}})}(jQuery);